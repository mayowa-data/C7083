---
title: "PLASTIC WASTE "
author: "Mayowa-Adebayo 2233800"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  '': default
pdf_document: 
keep_tex: yes
toc: yes
df_print: paged
theme: lumen
always_allow_html: yes
---


```{r,echo=FALSE,message=FALSE,warning=FALSE, results='hide'}
#setup
# Load the necessary library
library(maps)
library(tidyverse)
library(dplyr)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(sf)
library(rworldmap)
library(patchwork)
library(Cairo)
library(extrafont)
library(plotly)
library(viridis)
webshot::install_phantomjs(force = TRUE)

```

\newpage

```{r, echo=FALSE, include=FALSE, warning=FALSE, results='hide'}

#Assign the  data to a dataframe "plastics"
plastics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv')

#Remove NA values

plastics <- na.omit(plastics)
```

\newpage

# Background

Plastic pollution is a widespread and pressing global issue that poses a substantial and challenging threat to both living and non-living systems, causing significant environmental stress. Thushari et al. (2020) and Wilke et al. (2020) define plastic pollution as the infiltration of plastic materials, including macro-, micro-, and nanoplastic debris, into various environments, resulting from either direct introduction or degradation processes.

 This intrusion leads to negative impacts on ecosystems, particularly in areas where plastic is not native. Thus, there is a pressing need for analyzing the dataset on plastic pollution. The dataset provides information about the various types of plastic found during clean-up efforts by volunteers across different countries worldwide, as well as the names of companies producing plastics globally.
 The dataset is publicly available and obtained from the TidyTuesday GitHub page.

"[https:\\\\github.com\\rfordatascience](https:\\github.com\rfordatascience){.uri}"

The dataset contains 14 variable with 6472 observations as shown below;

```{r, echo=FALSE}

Variable <- c("country", "year", "parent_company", "empty", "hdpe", "ldpe", "o", "pet", "pp", "ps", "pvc", "grand_total", "num_events", "volunteers")
Class <- c("character", "numeric", "character", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric")
Description <- c("Country of cleanup",
                 "Year (2019 or 2020)",
                 "Source of plastic",
                 "Category left empty count",
                 "High density polyethylene count",
                 "Low density polyethylene count",
                 "Category marked other count",
                 "Polyester plastic count",
                 "Polypropylene count",
                 "Polystyrene count",
                 "PVC plastic count",
                 "Grand total count",
                 "Number of counting events",
                 "Number of volunteers")
plastics_df <- data.frame(Variable, Class, Description)
knitr::kable(plastics_df, align = "l")
```

\newpage
# Interactive barplot showing  plastics produced by countries using plotly

```{r, echo=FALSE, warning=FALSE}
# 1 Barplot showing  plastics produced by countries
## Change the country expression

plastics$country = gsub("United States of America", "USA", plastics$country)
plastics$country = gsub("United Kingdom of Great Britain & Northern Ireland",
                        "UK$ N Ireland", plastics$country)
plastics$country = gsub("United Arab Emirates", "UAE", plastics$country)

#filter to remove double country name

plastics <- plastics%>%
  filter(country != "NIGERIA")
# Replot to see changes
plastics %>%
  group_by(country) %>%
  summarize(total_waste = sum(grand_total)) %>%

plot_ly(x = ~country, y = ~total_waste, type = "bar",
        marker = list(color = "#1F77B4")) %>%
  layout(title = "Plastic Waste Generation by Country",
         xaxis = list(title = "Country"),
         yaxis = list(title = "Total Waste Generated"),
         hovermode = "closest",
         plot_bgcolor = "#F5F5F5",
         paper_bgcolor = "#F5F5F5",
         font = list(color = "#333333"),
         bargap = 0.1)
```
Figure 1 :The dataset is used to create an interactive barplot using the plot_ly() function from the plotly package. The x-axis shows the countries in the dataset and the y-axis shows the total waste generated by each country. We can denote from the barplot that the Philippines has the highest plastic waste generated followed by Nigeria and Switzerland.  

\newpage

# Map showing plastic waste distibution 

```{r, echo=FALSE, warning=FALSE, message=FALSE}

 #2 visualize the plastics produced on a map

#Data prep----
country_plastics <- plastics %>%
  group_by(country) %>%
  summarize(total_waste = sum(grand_total)) 

# Get worldmap
world_map <- map_data("world")

world_map <- getMap(resolution="high")

# Get centroids per country polygon
centroids <- gCentroid(world_map, byid=TRUE)

# Define df with centroids including x and y coordinate
centroid_df <- data.frame(centroids)

p <- cbind(rownames(centroid_df), data.frame(centroid_df, row.names =NULL ))
colnames(p) = c("country", "x", "y")


# Join df on countries
plastics_geo <- left_join(plastics, p,
                          by = 
                            "country")
plastics_geo <- na.omit(plastics_geo)

# Convert df to sf object
plastics_geo_sf <- sf::st_as_sf(plastics_geo, coords = c("x","y"), crs = 4326) 


# Change crs
st_crs(plastics_geo_sf) = 4326


# data visualisation----

# Download country polygons
world <- ne_countries(scale = "medium", returnclass = "sf")

map <- ggplot() +
  # Add country polygons
  geom_sf(data = world, fill = "#FFFFFF", color = "#2A363B", size = .2) +
  
  # Add point centroid locations
  geom_sf(data = plastics_geo_sf, color = "black", size = 3, alpha = .5) +
  geom_sf(data = plastics_geo_sf, color = "red", size = 1, alpha = .75)+
  
  
  # Add title and subtitle
  labs(subtitle = "Waste Plastics",
       title = "\nPLASTIC WASTE AROUND THE WORLD?") +
  
  # Get globe projection, set to northpole and europe
  coord_sf(crs = "+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs") +
  
  # Theming
  theme_minimal() +
  theme(plot.background = element_rect(fill = "#000000",
                                       color ="#000000"),
        plot.title = element_text(colour = "#FFFFFF",
                                  hjust = .5,
                                  family = "Bell MT",
                                  size = 20),
        plot.subtitle = element_text(colour ="#FFFFFF",
                                     hjust = .5,
                                     family = "Verdana"),
        panel.grid.major = element_line(size = .1))
map


#save plot
ggsave(map, filename = "globe.png", width = 14.8, height = 19, units = "cm", type = "cairo-png", dpi = 300)
```

Figure 2: displays the global distribution of plastic waste production by country. Red dots are used to indicate countries with high levels of plastic waste production, while black dots indicate lower levels. The use of a globe projection allows the viewer to visualize the distribution of plastic waste production in relation to the geography of the earth. The title and subtitle provide additional context. This image can be useful for further analysis, visualization, or as a communication tool to illustrate the global impact of plastic waste.

\newpage

# Which parent company produced more pet waste in philippines?

```{r, echo=FALSE, warning=FALSE, message=FALSE}
#3 Which parent company produced more pet waste  in philippines?
#
plastics_my <-  plastics%>% select(country, parent_company,year, pet)%>% 
  filter(country=="Philippines", year == 2020, pet > 0)%>% as.data.frame()

ggplot(plastics_my)+ aes(x= parent_company, y = pet)+
  geom_bar(stat ="identity",
           fill = "goldenrod")+coord_flip()
```

Figure 3: Shows parent company in the Philippines and the amount of PET plastic produced in 2020. Recall from figure 1 above that the Philippines has the highest plastic waste generated among countries. The unbranded plastic waste has the longest bar followed by the cocacola company. The barplot was produced using ggplot.

\newpage

# How much pet was produced in the years in view (2019, 2020)

```{r, echo=FALSE, warning=FALSE, message=FALSE}

 #4 How much pet was produced in the years in view (2019, 2020)
            
            library(vioplot)
            
            vioplot(pet ~ year, data = plastics, xlab= "YEAR", ylab = "PET",
                    col = "lightblue", main = "Pet plastic produced between 
                    2019 and 2020")
            
```

Figure 4 : displays beautiful light blue violin plot produced by vioplot() in base R
showing how much PET was produced in 2019 compare to 2020.More PET plastic were 
produced in 2020 from our analysis of the dataset.

\newpage

# Numbers of plastic waste by type and Year using ggplot

```{r, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
 # 5 Numbers of plastic waste by type and Year

# Reshape data from wide to long format

plastics_long <- plastics %>%
pivot_longer(cols = c("hdpe", "ldpe", "o", "pet", "pp", "ps", "pvc"),
names_to = "plastic_type", values_to = "value")

# Create grouped bar chart of plastic waste by type and year

ggplot(plastics_long, aes(x = year, y = value, fill = plastic_type)) +
 geom_col(position = "dodge") +
scale_fill_viridis_d(option = "magma")+
ggtitle("Plastic Waste by Type and Year") +
xlab("Year") +
ylab("Value") +
 theme_minimal() +
scale_y_continuous(limits = c(0, max(plastics_long$value) * 1.1))
theme(legend.position = "bottom")

```

Figure 5: Shows plastic wastes grouped by "Type and Year" of all the plastic waste 
presented in the dataset.
The plot were produced using ggplot.
"O"  which is a category of plastic marked as "others" was produced more in 2019 and
2020 followed by IDPE in 2019 and PET 2020 both of which are the most popular plastic waste around the world and as evidenced from the dataset.

\newpage

# Comparing Plastic waste clearing around the world by year and volunteer

```{r, echo=FALSE, warning=FALSE, message=FALSE}
           #6 Plastic waste clearing around the world
           par(mfrow = c(1, 2), mar = c(4, 4, 2, 1), oma = c(0, 0, 2, 0))
             with(plastics, {
             plot(volunteers, num_events,col = "lightblue",
                  pch = 16, main = "volunteers and number of events")
               
             plot(year, num_events, pch = 16, col= "green", main = "year and number of events")
             
             mtext("Plastic wastes Clearing event around the world", outer = TRUE)
             })
```

Figure 6: Shows a single plot divided into three column. the first plot shows the relationship between the number of volunteers and the number of events for plastic 
cleaning events.The second plot shows the relationship between the years and the
and the number of events of plastic clearing.


\newpage

```{r, echo=FALSE, fig.cap= "Carbon density maps", out.width="100%"}
knitr::include_graphics ("C:/Users/MAYOWA/OneDrive/Desktop/Bad graph visualization.png")
```

Bad Data Visualization

The Nature article titled "Sub-continental scale carbon stocks of individual trees in African drylands" presents the findings of an experiment aimed at estimating the above-ground carbon density of individual trees in African dryland regions. The research team used a combination of remote sensing data, field measurements, and statistical models to estimate above-ground carbon density on a sub-continental scale. Tucker et al.

However, the graph suffers from several design flaws, which make it cumbersome and challenging to interpret. Firstly, there is too much information presented within the graph, making it overwhelming for non-experts to comprehend. The graph contains multiple lines, colors, and labels, which can be confusing and difficult to interpret.

Secondly, the use of color within the graph is excessive and does not add any value to the presentation of the data. Color should be used sparingly and only where necessary to communicate information effectively. In this case, the use of different colors for each line and the background color makes it difficult to read and understand the information presented.

Thirdly, the axes are poorly labeled, and there is no clear indication of the units used for measurement. The lack of clear labeling makes it difficult to interpret the data and limits the graph's effectiveness as a tool for communicating complex information.

Overall, the graph used to present the experiment in the Nature article is not a good visualization. The design flaws within the graph limit its effectiveness as a tool for communicating complex data. To improve the visualization of the study's findings, it is essential to use clear and concise graphics that are easy to read and interpret. Proper visualization techniques can make a significant difference in how data is interpreted, allowing for a better understanding of complex information.


\newpage
```{r, echo=FALSE, fig.cap= "Carbon respiration from subsurface peatmaps", out.width="100%"}
knitr::include_graphics ("C:/Users/MAYOWA/OneDrive/Desktop/good graphs.png")
```

Good Data Visualization

The graph above presents a comparison of subarctic peatland's response during summer and spring, based on a recent study by Dorrepaal, et al. (2009). The authors conducted an 8-year experiment of warming subarctic peatland and found that a 1°C increase in temperature stimulated respiration rates by 50% on average.

The graph clearly indicates that the respiration rates were higher during summer than in spring. The vertical axis represents the respiration rates, while the horizontal axis represents time. The colors used in the graph are easily distinguishable and clear, making it an effective tool for communicating scientific data.

This graph is a well-designed visualization tool that presents the data in a clear and understandable manner. The labeling of the two axes is simple and informative, making it easy for readers to understand the findings. Additionally, the graph is not overloaded with extraneous information, making it an effective and efficient means of presenting scientific data.

In conclusion, the graph above illustrates that a 1°C warming of subarctic peatland stimulates respiration rates by 50%, with higher rates observed during summer. The graph's clear presentation and effective use of color make it a valuable visualization tool for conveying scientific data.

\newpage

# Reference

Dorrepaal, E., Toet, S., van Logtestijn, R., et al. (2009) Carbon respiration from subsurface peat accelerated by climate warming in the subarctic. Nature, 460(7255), pp. 616-619. doi: 10.1038/nature08216

Thushari, G. G. N. and Senevirathna, J. D. M., 2020. Plastic Pollution in the Marine Environment. Heliyon, 6, e04709. DOI: 10.1016/j.heliyon.2020.e04709.

Tucker, C., Brandt, M., Hiernaux, P. et al. 2023, 'Sub-continental-scale carbon stocks of individual trees in African drylands', Nature, vol. 615, no.

Wilke, C., 2020. Plastics Are Showing up in the World’s Most Remote Places, Including Mount Everest. Science News, [online] Available at: https://www.sciencenews.org/article/plastics-microplastics-mount-everest-worlds-most-remote-places [Accessed 8 March 2023].



